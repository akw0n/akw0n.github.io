<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>shieps.io</title>
	<style>
		* { padding: 0; margin: 0; }
		canvas { background: #eee; display: block; margin: 0 auto; }
	</style>
</head>
<body>
	<script>
		var canvas = document.createElement("canvas");
		var ctx = canvas.getContext("2d");
		canvas.width = 1024;
		canvas.height = 768;
		document.body.appendChild(canvas);

		width = canvas.width;
		height = canvas.height;

		var xPos = width/2, yPos = height/2, baseForwardVelocity = 0, baseBackwardVelocity = 0; angle = 0, rSpeed = 1.5, xVelocity = 0, yVelocity = 0, maxVelocity = 10, acceleration = .25, deceleration = .25;

		var leftPressed = false, rightPressed = false, upPressed = false, downPressed = false;

		function update() {
			requestAnimationFrame(update);
			ctx.clearRect(0, 0, width, height);

			if (leftPressed) {
				increment(false);
			} 
			if (rightPressed) {
				increment(true);
			}
			
			if (upPressed) {
				if (baseBackwardVelocity > 0) {
					baseBackwardVelocity -= deceleration;
					accelerate(baseBackwardVelocity);
				} else if (baseForwardVelocity < maxVelocity) {
					baseForwardVelocity += acceleration;
				}  else {
					baseForwardVelocity = maxVelocity;
				}
				accelerate(-baseForwardVelocity);

			} else if (downPressed) {
				if (baseForwardVelocity > 0) {
					baseForwardVelocity -= deceleration;				
					accelerate(-baseForwardVelocity);
				} else if (baseBackwardVelocity < maxVelocity) {
					baseBackwardVelocity += acceleration;
				} else {
					baseBackwardVelocity = maxVelocity;
				}
				accelerate(baseBackwardVelocity);
			} else if (baseBackwardVelocity > 0) {
				baseBackwardVelocity -= deceleration;
				accelerate(baseBackwardVelocity);
			} else if (baseForwardVelocity > 0) {
				baseForwardVelocity -= deceleration;
				accelerate(-baseForwardVelocity);
			} 


			if (xPos <= -1) {
				xPos = width;
			} else if (xPos >= width+1) {
				xPos = 0;
			} 
			if (yPos <= 50) {
				yPos = 50;
			} else if (yPos >= height-85) {
				yPos = height - 85;
			}

			drawPlayer(xPos, yPos, 25);
		}

		function accelerate(velocity) {
			xVelocity = velocity * Math.cos(toRadians(angle));
			yVelocity = velocity * Math.sin(toRadians(angle));

			xPos += xVelocity;
			yPos += yVelocity;
		}

		function toRadians(angle) {
			return angle * (Math.PI/180);
		}

		function drawPlayer(x, y, radius) {
			ctx.clearRect(0,0,width,height);
			ctx.save();
			ctx.translate(x + radius/2, y + radius/2);
			ctx.rotate(toRadians(angle));
			ctx.fillStyle = "#0095DD"
			ctx.scale(3,1);
			ctx.beginPath();
			ctx.arc(0, 0, radius, 0, 2 * Math.PI, false);
			ctx.fill();
			ctx.fillStyle = "black";
			ctx.fillRect(-(radius/2),-2,5,5);  
			ctx.fillRect(7,-2,5,5);          
     
			ctx.restore();
		}

		function increment(clockwise) {
			if (clockwise == true) {
				angle += rSpeed;
			} else {
				angle -= rSpeed;
			}
			if (angle > 360) {
				angle = 0;
			}
			if (angle < 0) {
				angle = 360;
			}
		}

		document.addEventListener("keydown", keyDownHandler, false);
		document.addEventListener("keyup", keyUpHandler, false);

		function keyDownHandler(e) {
			if(e.keyCode == 39) {
				rightPressed = true;
			}
			else if(e.keyCode == 37) {
				leftPressed = true;
			}
			if (e.keyCode == 38) {
				upPressed = true;
			} else if (e.keyCode == 40) {
				downPressed = true;
			}
		}

		function keyUpHandler(e) {
			if(e.keyCode == 39) {
				rightPressed = false;
			}
			else if(e.keyCode == 37) {
				leftPressed = false;
			}
			if (e.keyCode == 38) {
				upPressed = false;
			} else if (e.keyCode == 40) {
				downPressed = false;
			}
		}

		update();



	</script>
</body>
</html>
