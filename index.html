<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>shieps.io</title>
	<style>
		* { padding: 0; margin: 0; }
		canvas { background: #eee; display: block; margin: 0 auto; }
	</style>
</head>
<body>
	<script>
		var canvas = document.createElement("canvas");
		var ctx = canvas.getContext("2d");
		canvas.width = 1024;
		canvas.height = 768;
		document.body.appendChild(canvas);

		width = canvas.width;
		height = canvas.height;

		var xPos = width/2, yPos = height/2, baseSpeed = 10, angle = 0, rSpeed = 3, xVelocity = 0, yVelocity = 0, fInertia = 10, bInertia = 10;

		var leftPressed = false, rightPressed = false, upPressed = false, downPressed = false;

		function update() {
			requestAnimationFrame(update);
			ctx.clearRect(0, 0, width, height);

			yVelocity = (baseSpeed * Math.sin(toRadians(angle)));
			xVelocity = (baseSpeed * Math.cos(toRadians(angle)));

			if (leftPressed) {
				increment(false);
			} 
			if (rightPressed) {
				increment(true);
			}
			if (upPressed) {
				if (bInertia < 10) {
					bInertia += .1;
					yPos += yVelocity/bInertia;
					xPos += xVelocity/bInertia; 
				}
				if (fInertia > 1.1) {
					fInertia -= .1;
				} else {
					fInertia = 1;
				}
				yPos -= yVelocity/fInertia;
				xPos -= xVelocity/fInertia; 
			} else if (downPressed) {
				if (fInertia < 10) {
					fInertia += .1;
					yPos -= yVelocity/fInertia;
					xPos -= xVelocity/fInertia; 
				}
				if (bInertia > 1.1) {
					bInertia -= .1;
				} else {
					bInertia = 1;
				}
				yPos += yVelocity/bInertia;
				xPos += xVelocity/bInertia;
			} else {
				if (fInertia < 10) {
					fInertia += .1;
					yPos -= yVelocity/fInertia;
					xPos -= xVelocity/fInertia; 
				} 
				if (bInertia < 10) {
					bInertia += .1;
					yPos += yVelocity/bInertia;
					xPos += xVelocity/bInertia; 
				}
			}
			
			if (xPos <= -1) {
				xPos = width;
			} else if (xPos >= width+1) {
				xPos = 0;
			} 
			if (yPos <= -1) {
				yPos = height;
			} else if (yPos >= height+1) {
				yPos = 0;
			}

			drawPlayer(xPos, yPos);
		}

		function toRadians(angle) {
			return angle * (Math.PI/180);
		}

		function drawPlayer(x, y) {
			ctx.clearRect(0,0,width,height);
			
			ctx.save();
			ctx.translate(x + 25, y + 25);
			ctx.rotate(toRadians(angle));

			ctx.fillStyle = "#0095DD"
			ctx.fillRect(-25,-25,50,50); 
			ctx.fillStyle = "black";
			ctx.fillRect(-25,-2,5,5);          

			ctx.restore();
		}

		function increment(clockwise) {
			if (clockwise == true) {
				angle += rSpeed;
			} else {
				angle -= rSpeed;
			}
			if (angle > 360) {
				angle = 0;
			}
			if (angle < 0) {
				angle = 360;
			}
		}

		document.addEventListener("keydown", keyDownHandler, false);
		document.addEventListener("keyup", keyUpHandler, false);

		function keyDownHandler(e) {
			if(e.keyCode == 39) {
				rightPressed = true;
			}
			else if(e.keyCode == 37) {
				leftPressed = true;
			}
			if (e.keyCode == 38) {
				upPressed = true;
			} else if (e.keyCode == 40) {
				downPressed = true;
			}
		}

		function keyUpHandler(e) {
			if(e.keyCode == 39) {
				rightPressed = false;
			}
			else if(e.keyCode == 37) {
				leftPressed = false;
			}
			if (e.keyCode == 38) {
				upPressed = false;
			} else if (e.keyCode == 40) {
				downPressed = false;
			}
		}

		update();

		
		
	</script>
</body>
</html>
