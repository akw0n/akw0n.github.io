<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Ships.io</title>
	<style>
		* { padding: 0; margin: 0; }
		canvas { background: #eee; display: block; margin: 0 auto; }
	</style>
</head>
<body>
	<script>
		var canvas = document.createElement("canvas");
		var ctx = canvas.getContext("2d");
		canvas.width = 1024;
		canvas.height = 768;
		document.body.appendChild(canvas);

		width = canvas.width;
		height = canvas.height;

		var xPos = width/2, yPos = height/2, baseSpeed = 5, angle = 0, rSpeed = 3, acceleration = 3, xVelocity = 0, yVelocity = 0, fMomentum = 5, bMomentum = 5;

		var leftPressed = false, rightPressed = false, upPressed = false, downPressed = false;

		function update() {
			requestAnimationFrame(update);
			ctx.clearRect(0, 0, width, height);

			yVelocity = (baseSpeed * Math.sin(toRadians(angle)));
			xVelocity = (baseSpeed * Math.cos(toRadians(angle)));

			if (leftPressed) {
				increment(false);
			} 
			if (rightPressed) {
				increment(true);
			}
			if (upPressed) {
				if (fMomentum > 1.1) {
					fMomentum -= .1;
				} else {
					fMomentum = 1;
				}
				yPos -= (baseSpeed*Math.sin(toRadians(angle)))/fMomentum;
				xPos -= (baseSpeed*Math.cos(toRadians(angle)))/fMomentum; 
			} else if (downPressed) {
				if (bMomentum > 1.1) {
					bMomentum -= .1;
				} else {
					bMomentum = 1;
				}
				yPos += (baseSpeed*Math.sin(toRadians(angle)))/bMomentum;
				xPos += (baseSpeed*Math.cos(toRadians(angle)))/bMomentum;
			} else {
				if (fMomentum < 10) {
					fMomentum += .1;
					yPos -= (baseSpeed*Math.sin(toRadians(angle)))/fMomentum;
					xPos -= (baseSpeed*Math.cos(toRadians(angle)))/fMomentum; 
				} 
				if (bMomentum < 10) {
					bMomentum += .1;
					yPos += (baseSpeed*Math.sin(toRadians(angle)))/bMomentum;
					xPos += (baseSpeed*Math.cos(toRadians(angle)))/bMomentum; 
				}
			}
			
			if (xPos <= -1) {
				xPos = width;
			} else if (xPos >= width+1) {
				xPos = 0;
			} 
			if (yPos <= -1) {
				yPos = height;
			} else if (yPos >= height+1) {
				yPos = 0;
			}

			drawPlayer(xPos, yPos);
		}

		function toRadians(angle) {
			return angle * (Math.PI/180);
		}

		function drawPlayer(x, y) {
			ctx.clearRect(0,0,width,height);
			
			ctx.save();
			ctx.translate(x + 25, y + 25);
			ctx.rotate(toRadians(angle));

			ctx.fillStyle = "#0095DD"
			ctx.fillRect(-25,-25,50,50); 
			ctx.fillStyle = "black";
			ctx.fillRect(-25,-2,5,5);          

			ctx.restore();
		}

		function increment(clockwise) {
			if (clockwise == true) {
				angle += rSpeed;
			} else {
				angle -= rSpeed;
			}
			if (angle > 360) {
				angle = 0;
			}
			if (angle < 0) {
				angle = 360;
			}
		}

		document.addEventListener("keydown", keyDownHandler, false);
		document.addEventListener("keyup", keyUpHandler, false);

		function keyDownHandler(e) {
			if(e.keyCode == 39) {
				rightPressed = true;
			}
			else if(e.keyCode == 37) {
				leftPressed = true;
			}
			if (e.keyCode == 38) {
				upPressed = true;
			} else if (e.keyCode == 40) {
				downPressed = true;
			}
		}

		function keyUpHandler(e) {
			if(e.keyCode == 39) {
				rightPressed = false;
			}
			else if(e.keyCode == 37) {
				leftPressed = false;
			}
			if (e.keyCode == 38) {
				upPressed = false;
			} else if (e.keyCode == 40) {
				downPressed = false;
			}
		}

		update();

		
		
	</script>
</body>
</html>